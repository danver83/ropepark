(()=>{"use strict";function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)}function e(t){var e=o();return function(){var n,i=a(t);if(e){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function n(t){var e="function"==typeof Map?new Map:void 0;return n=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return i(t,arguments,a(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),r(n,t)},n(t)}function i(t,e,n){return i=o()?Reflect.construct.bind():function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},i.apply(null,arguments)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function p(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:String(e)}var _=function(){function t(e,n){if(h(this,t),!(e instanceof Element))throw new TypeError("TSortable container is not an Element");this._container=e;var i=(n="[object Object]"===Object.prototype.toString.call(n)?n:{}).dragImage||{},o=n.ghost||{},r=n.autoScroll||{};this._config={containerClassName:n.containerClassName||"tsort",dragImage:{className:i.className||"tsort__drag-image",opacity:!isNaN(i.opacity)&&i.opacity>=0&&i.opacity<=1?i.opacity:1,zIndex:isNaN(i.zIndex)?1e4:i.zIndex,appendTo:i.appendTo instanceof Element?i.appendTo:document.body},selector:n.selector||".tsort__item",cancelSelector:n.cancelSelector||".tsort__item_cancel",handleSelector:n.handleSelector||".tsort__item",ghost:{className:o.className||"tsort__ghost"},autoScroll:{isEnabled:void 0===r.isEnabled||!!r.isEnabled,speedIndex:!isNaN(r.speedIndex)&&r.speedIndex>0?r.speedIndex:1,offset:!isNaN(r.offset)&&r.offset>0?r.offset:60},toleranceDistance:!isNaN(n.toleranceDistance)&&n.toleranceDistance>=0?n.toleranceDistance:6,delay:!isNaN(n.delay)&&n.delay>=0?n.delay:50,touchDelay:!isNaN(n.touchDelay)&&n.touchDelay>=0?n.touchDelay:300,touchDistance:!isNaN(n.touchDistance)&&n.touchDistance>=0?n.touchDistance:20,axis:["x","y","both"].includes(n.axis)?n.axis:"both",isAutoUpdateEnabled:!!n.isAutoUpdateEnabled},this._config.autoScroll.container=r.container instanceof Element?r.container:this._getAutoScrollContainer(),this._sortableElements=Array.from(this._container.querySelectorAll(this._config.selector)),this._onStart="function"==typeof n.onStart?n.onStart:new Function,this._onMove="function"==typeof n.onMove?n.onMove:new Function,this._onEnd="function"==typeof n.onEnd?n.onEnd:new Function,this._onDrop="function"==typeof n.onDrop?n.onDrop:new Function,this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handleDragStart=this._handleDragStart.bind(this),this._handleDrop=this._handleDrop.bind(this),this._handleDragMove=this._handleDragMove.bind(this),this._handleDragEnd=this._handleDragEnd.bind(this),this._preventDefaultDrag=this._preventDefaultDrag.bind(this),this._preventContextMenu=this._preventContextMenu.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._pointerState={isButtonPressed:!1,startPosX:null,startPosY:null,startTimestamp:null,targetElement:null},this._isDropped=!1,this._isDisabled=!1,this._isDragStarted=!1,this._dragImage=null,this._draggingElement=null,this._autoScrollSpeed=0,this._autoScrollAccumulator=0,this._draggingElIndex=null,this._prevSwappedEl=null,this._isTouchDevice=!window.matchMedia("(hover: hover)").matches}return d(t,[{key:"_getAutoScrollContainer",value:function(){for(var t=this._container,e=["auto","scroll","overlay"];t&&t!==document.documentElement;){var n=window.getComputedStyle(t).getPropertyValue("overflow-y");if(e.includes(n))break;t=t.parentElement}return t||document.documentElement}},{key:"_getDragImage",value:function(t){var e=this._config.dragImage,n=t.cloneNode(!0),i=t.getBoundingClientRect();n.classList.add(e.className),n.style.opacity=e.opacity,n.style.zIndex=e.zIndex,n.style.position="fixed",n.style.width=i.width+"px",n.style.height=i.height+"px",n.style.top=i.top+"px",n.style.left=i.left+"px",e.appendTo.appendChild(n),this._dragImage=n}},{key:"_disableSelection",value:function(){document.body.style.setProperty("user-select","none"),document.body.style.setProperty("-webkit-user-select","none"),document.documentElement.style.cursor="default"}},{key:"_enableSelection",value:function(){document.body.style.removeProperty("user-select"),document.body.style.removeProperty("-webkit-user-select"),document.documentElement.style.removeProperty("cursor")}},{key:"_setAutoScrollSpeed",value:function(t){var e=this;if(this._autoScrollSpeed=t,this._scrollAnimationFrame&&!t)return cancelAnimationFrame(this._scrollAnimationFrame),this._scrollAnimationFrame=null,void(this._autoScrollAccumulator=0);if(t){var n,i=this._config.autoScroll.container;this._scrollAnimationFrame=requestAnimationFrame((function t(o){if(e._scrollAnimationFrame&&!e._autoScrollSpeed)return cancelAnimationFrame(e._scrollAnimationFrame),e._scrollAnimationFrame=null,void(e._autoScrollAccumulator=0);void 0===n&&(n=o);var r=(o-n)/1e3*e._autoScrollSpeed;e._autoScrollAccumulator+=r,(e._autoScrollSpeed>0&&e._autoScrollAccumulator>=1||e._autoScrollSpeed<0&&e._autoScrollAccumulator<=-1)&&(i.scrollTop+=Math.floor(e._autoScrollAccumulator),e._autoScrollAccumulator=0),n=o,e._scrollAnimationFrame=requestAnimationFrame(t)}))}}},{key:"_enableAutoUpdate",value:function(){var t=this,e=this._container;this._observer=new MutationObserver((function(e){var n=[];e.forEach((function(t){n.push.apply(n,l(Array.from(t.addedNodes)).concat(l(Array.from(t.removedNodes))))}));for(var i=0;i<n.length;i++){var o=n[i];if(o.nodeType===Node.ELEMENT_NODE&&o.matches(t._config.selector)){t.update();break}}})),this._observer.observe(e,{childList:!0,subtree:!0})}},{key:"_preventContextMenu",value:function(t){var e=this._config.selector,n=this._config.cancelSelector;this._isDisabled||!t.target.closest(e)||t.target.closest(n)||(t.preventDefault(),t.stopPropagation())}},{key:"_preventDefaultDrag",value:function(t){t.target.closest&&t.target.closest(this._config.selector)&&(t.preventDefault(),t.stopPropagation())}},{key:"init",value:function(){this._container.classList.add(this._config.containerClassName),this._container.style.position="relative",this._isTouchDevice?(document.addEventListener("touchstart",this._handleTouchStart),window.addEventListener("contextmenu",this._preventContextMenu,{passive:!1,capture:!0})):document.addEventListener("mousedown",this._handlePointerDown),this._container.addEventListener("tDragStartLite",this._handleDragStart),this._container.addEventListener("tDragMoveLite",this._handleDragMove),this._container.addEventListener("tDragEndLite",this._handleDragEnd),this._container.addEventListener("tDropLite",this._handleDrop),document.addEventListener("dragstart",this._preventDefaultDrag,{passive:!1,capture:!0}),this._isTouchDevice&&this._sortableElements.forEach((function(t){t.style.setProperty("user-select","none"),t.style.setProperty("-webkit-touch-callout","none")})),this._config.isAutoUpdateEnabled&&this._enableAutoUpdate(),this._config.autoScroll.container.style.setProperty("overflow-anchor","none")}},{key:"disable",value:function(){this._isDisabled=!0}},{key:"enable",value:function(){this._isDisabled=!1}},{key:"destroy",value:function(){this._container.classList.remove(this._config.containerClassName),this._container.style.removeProperty("position"),this._isTouchDevice?(document.removeEventListener("touchstart",this._handleTouchStart),document.removeEventListener("touchmove",this._handleTouchMove,{passive:!1}),document.removeEventListener("touchend",this._handleTouchEnd),window.removeEventListener("contextmenu",this._preventContextMenu,{passive:!1,capture:!0})):(document.removeEventListener("mousedown",this._handlePointerDown),document.removeEventListener("mousemove",this._handlePointerMove),document.removeEventListener("mouseup",this._handlePointerUp)),this._container.removeEventListener("tDragStartLite",this._handleDragStart),this._container.removeEventListener("tDragMoveLite",this._handleDragMove),this._container.removeEventListener("tDragEndLite",this._handleDragEnd),this._container.removeEventListener("tDropLite",this._handleDrop),document.removeEventListener("dragstart",this._preventDefaultDrag,{passive:!1,capture:!0}),this._isTouchDevice&&this._sortableElements.forEach((function(t){t.style.removeProperty("user-select"),t.style.removeProperty("-webkit-touch-callout")}))}},{key:"update",value:function(){this._sortableElements=Array.from(this._container.querySelectorAll(this._config.selector)),this._isTouchDevice&&this._sortableElements.forEach((function(t){t.style.setProperty("user-select","none"),t.style.setProperty("-webkit-touch-callout","none")}))}},{key:"_handlePointerDown",value:function(t){this._isDisabled||this._isDragStarted||this._pointerState.isButtonPressed||1!==t.buttons||!t.target.closest(this._config.handleSelector)||!this._container.contains(t.target)||t.target.closest(this._config.selector).matches(this._config.cancelSelector)||(this._disableSelection(),this._pointerState.isButtonPressed=!0,this._pointerState.startPosX=t.clientX,this._pointerState.startPosY=t.clientY,this._pointerState.startTimestamp=performance.now(),this._pointerState.targetElement=t.target.closest(this._config.selector),document.addEventListener("mousemove",this._handlePointerMove),document.addEventListener("mouseup",this._handlePointerUp))}},{key:"_handlePointerMove",value:function(t){if(!this._isDisabled){1!==t.buttons&&(this._pointerState.isButtonPressed=!1);var e=this._pointerState.startPosX||0,n=this._pointerState.startPosY||0,i=t.clientX,o=t.clientY,r=Math.sqrt(Math.pow(i-e,2)+Math.pow(o-n,2)),a=this._pointerState.startTimestamp||0,s=performance.now()-a;if(this._isDragStarted&&1===t.buttons){var l=new m(this,t);this._container.dispatchEvent(l)}else if(!this._isDragStarted&&1===t.buttons&&this._pointerState.isButtonPressed&&r>=this._config.toleranceDistance&&s>=this._config.delay){this._isDragStarted=!0,this._draggingElIndex=this._sortableElements.indexOf(this._pointerState.targetElement);var c=new v(this,t);this._container.dispatchEvent(c)}else;}}},{key:"_handlePointerUp",value:function(t){if(!this._isDisabled){if(this._enableSelection(),this._isDragStarted){if(this._draggingElIndex!==this._sortableElements.indexOf(this._pointerState.targetElement)){var e=new y(this,t);this._container.dispatchEvent(e),this._isDropped=!0}var n=new g(this,t);this._container.dispatchEvent(n)}this._pointerState.isButtonPressed=!1,this._pointerState.startPosX=null,this._pointerState.startPosY=null,this._pointerState.startTimestamp=null,this._pointerState.targetElement=null,this._isDragStarted=!1,this._draggingElIndex=null,document.removeEventListener("mousemove",this._handlePointerMove),document.removeEventListener("mouseup",this._handlePointerUp)}}},{key:"_handleTouchStart",value:function(t){this._isDisabled||this._isDragStarted||this._pointerState.isButtonPressed||1!==t.touches.length||!t.target.closest(this._config.handleSelector)||!this._container.contains(t.target)||t.target.closest(this._config.selector).matches(this._config.cancelSelector)||(this._disableSelection(),this._pointerState.isButtonPressed=!0,this._pointerState.startPosX=t.touches[0].clientX,this._pointerState.startPosY=t.touches[0].clientY,this._pointerState.startTimestamp=performance.now(),this._pointerState.targetElement=t.target.closest(this._config.selector),document.addEventListener("touchmove",this._handleTouchMove,{passive:!1}),document.addEventListener("touchend",this._handleTouchEnd))}},{key:"_handleTouchMove",value:function(t){if(!this._isDisabled)if(this._isDragStarted){t.cancelable&&t.preventDefault();var e=new m(this,t);this._container.dispatchEvent(e)}else if(this._pointerState.isButtonPressed){var n=performance.now(),i=this._pointerState.startPosX,o=this._pointerState.startPosY,r=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY,s=Math.sqrt(Math.pow(r-i,2)+Math.pow(a-o,2)),l=n-this._pointerState.startTimestamp;if(t.cancelable&&s<this._config.touchDistance&&l>=this._config.touchDelay){t.preventDefault(),this._draggingElIndex=this._sortableElements.indexOf(this._pointerState.targetElement),this._isDragStarted=!0;var c=new v(this,t);this._container.dispatchEvent(c)}}}},{key:"_handleTouchEnd",value:function(t){if(!this._isDisabled){if(this._enableSelection(),this._isDragStarted){if(this._draggingElIndex!==this._sortableElements.indexOf(this._pointerState.targetElement)){var e=new y(this,t);this._container.dispatchEvent(e),this._isDropped=!0}var n=new g(this,t);this._container.dispatchEvent(n)}this._pointerState.isButtonPressed=!1,this._pointerState.startPosX=null,this._pointerState.startPosY=null,this._pointerState.startTimestamp=null,this._pointerState.targetElement=null,this._isDragStarted=!1,this._draggingElIndex=null,document.removeEventListener("touchmove",this._handleTouchMove,{passive:!1}),document.removeEventListener("touchend",this._handleTouchEnd)}}},{key:"_handleDragStart",value:function(t){this._onStart.call(null,t),this._isTouchDevice&&"function"==typeof window.navigator.vibrate&&window.navigator.vibrate(10),this._draggingElement=t.draggingElement,this._getDragImage(this._draggingElement);var e=this._config.ghost.className;this._draggingElement.classList.add(e),this._draggingElement.style.pointerEvents="none",this._draggingElement.style.visibility="hidden"}},{key:"_handleDragMove",value:function(t){this._onMove.call(null,t);var e,n,i=t.draggingElement,o=this._config.axis,r=this._pointerState.startPosX,a=this._pointerState.startPosY;t.originalEvent.type.includes("touch")?(e=t.originalEvent.changedTouches[0].clientX,n=t.originalEvent.changedTouches[0].clientY):(e=t.originalEvent.clientX,n=t.originalEvent.clientY),"both"===o?this._dragImage.style.translate="".concat(e-r,"px ").concat(n-a,"px"):"x"===o?this._dragImage.style.translate="".concat(e-r,"px 0"):"y"===o&&(this._dragImage.style.translate="0 ".concat(n-a,"px"));for(var s,l=this._sortableElements.filter((function(t){return t!==i})),c=l.map((function(t){return t.getBoundingClientRect()})),h=null,u=0;u<c.length;u++){var d=c[u];if("both"===o&&e>=d.left&&e<=d.left+d.width&&n>=d.top&&n<=d.top+d.height||"x"===o&&e>=d.left&&e<=d.left+d.width||"y"===o&&n>=d.top&&n<=d.top+d.height){h=l[u];break}}h&&this._prevSwappedEl!==h?(s=this._sortableElements.indexOf(h)>this._sortableElements.indexOf(i)?"afterend":"beforebegin",h.insertAdjacentElement(s,i),this._prevSwappedEl=h,this._isTouchDevice&&"function"==typeof window.navigator.vibrate&&window.navigator.vibrate(10),this._config.isAutoUpdateEnabled||this.update()):h||(this._prevSwappedEl=null);var p=this._config.autoScroll,_=p.container;if(p.isEnabled){var f=_.getBoundingClientRect(),v=Math.max(f.top,0),m=Math.min(f.bottom,document.documentElement.clientHeight),g=n-v-p.offset,y=m-n-p.offset,S=p.speedIndex;g<0?this._setAutoScrollSpeed(S*Math.pow(g,3)/5e3):y<0?this._setAutoScrollSpeed(-1*S*(Math.pow(y,3)/5e3)):this._setAutoScrollSpeed(0)}}},{key:"_handleDrop",value:function(t){window.setTimeout(this._onDrop.bind(null,t),0),this._isTouchDevice&&"function"==typeof window.navigator.vibrate&&window.navigator.vibrate(10)}},{key:"_handleDragEnd",value:function(t){this._onEnd.call(null,t),this._setAutoScrollSpeed(0),this._dragImage.remove(),this._dragImage=null,this._draggingElement=null,this._isDropped=!1,this._isDragStarted=!1,this._prevSwappedEl=null;var e=this._config.ghost.className,n=t.draggingElement;n.style.removeProperty("pointer-events"),n.style.removeProperty("visibility"),n.classList.remove(e)}}]),t}(),f=function(n){t(o,n);var i=e(o);function o(t,e,n){var r;h(this,o),r=i.call(this,n,{cancelable:!0});var a=t._pointerState;return r.originalEvent=e,r.draggingElement=a.targetElement,r.dragStartPos={x:a.startPosX,y:a.startPosY},r.dragStartTimestamp=a.startTimestamp,r}return d(o)}(n(CustomEvent)),v=function(n){t(o,n);var i=e(o);function o(t,e){return h(this,o),i.call(this,t,e,"tDragStartLite")}return d(o)}(f),m=function(n){t(o,n);var i=e(o);function o(t,e){return h(this,o),i.call(this,t,e,"tDragMoveLite")}return d(o)}(f),g=function(n){t(o,n);var i=e(o);function o(t,e,n){return h(this,o),i.call(this,t,e,n||"tDragEndLite")}return d(o)}(f),y=function(n){t(o,n);var i=e(o);function o(t,e){var n;return h(this,o),(n=i.call(this,t,e,"tDropLite")).relativeTargets={prevEl:t._draggingElement.previousElementSibling||null,nextEl:t._draggingElement.nextElementSibling||null},n}return d(o)}(g);window.TSortableLite=_})();